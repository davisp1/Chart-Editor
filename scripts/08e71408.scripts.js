"use strict";function removeAccents(a){a=a.split("");for(var b=[],c=a.length,d="ÀÁÂÃÄÅàáâãäåÒÓÔÕÕÖØòóôõöøÈÉÊËèéêëðÇçÐÌÍÎÏìíîïÙÚÛÜùúûüÑñŠšŸÿýŽž",e=["A","A","A","A","A","A","a","a","a","a","a","a","O","O","O","O","O","O","O","o","o","o","o","o","o","E","E","E","E","e","e","e","e","e","C","c","D","I","I","I","I","i","i","i","i","U","U","U","U","u","u","u","u","N","n","S","s","Y","y","y","Z","z"],f=0;c>f;f++)b[f]=-1!==d.indexOf(a[f])?e[d.indexOf(a[f])]:a[f];return b=b.join("")}function hasClass(a,b){for(var c=a.className.split(" "),d=0;d<c.length;d++)if(c[d].toLowerCase()===b.toLowerCase())return!0;return!1}angular.module("newChartEditorApp",["ngCookies","ngResource","ngSanitize","ngRoute","ngStorage","ui.bootstrap","angularFileUpload","angularSpinner","ngTable"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/dataset/create",{templateUrl:"views/dataset.html",controller:"DataSetEditCtrl"}).when("/dataset/edit/:datasetId",{templateUrl:"views/dataset.html",controller:"DataSetEditCtrl"}).otherwise({redirectTo:"/"})}]).run(["$templateCache",function(a){a.put("toto.html",'<tr> <th ng-repeat="column in titles" ng-class="{ \'sortable\': parse(column.sortable), \'sort-asc\': params.sorting()[parse(column.sortable)]==\'asc\', \'sort-desc\': params.sorting()[parse(column.sortable)]==\'desc\' }" ng-click="sortBy(column)" ng-show="column.show(this)" ng-init="template=column.headerTemplateURL(this)" class="header {{column.class}}"> <div ng-if="!template" ng-show="!template" ng-bind="parse(column.title)"></div> <div ng-if="template" ng-show="template"><div ng-include="template"></div></div> </th> </tr> <tr ng-show="show_filter" class="ng-table-filters"> <th ng-repeat="column in $columns" ng-show="column.show(this)" class="filter"> <div ng-repeat="(name, filter) in column.filter"> <div ng-if="column.filterTemplateURL" ng-show="column.filterTemplateURL"> <div ng-include="column.filterTemplateURL"></div> </div> <div ng-if="!column.filterTemplateURL" ng-show="!column.filterTemplateURL"> <div ng-include="\'ng-table/filters/\' + filter + \'.html\'"></div> </div> </div> </th> </tr>')}]),angular.module("newChartEditorApp").controller("DataSetEditCtrl",["$scope","$routeParams","$rootScope","$upload","$localStorage","$location","ngTableParams","$filter","$compile","usSpinnerService",function(a,b,c,d,e,f,g,h,i,j){if(c.currentDataset=b.datasetId,a.datasetId=b.datasetId,a.$storage=e.$default({datasets:{}}),a.data=[],a.computeData=function(){a.jsonDataAsText=JSON.stringify(a.data,null,"	");var b=a.data.map(function(a){return a.join("	")}),c=b.join("\n");a.dataFromCopy=c,j.stop("spinner-1")},a.datasetId){var k=a.$storage.datasets[a.datasetId];"undefined"!=typeof k&&(a.data=k.data,a.datasetTitle=k.title||"",a.titles=k.titles,a.computeData())}a.onFileSelect=function(b){j.spin("spinner-1"),a.parseFile(b[0])},a.formatTitles=function(b){for(var c=[],d=0;d<a.data[0].length;d++)c.push("undefined"==typeof b[d]?{title:"col"+d,field:"col"+d}:"undefined"!=typeof b[d].title?b[d]:{title:b[d],field:"col"+d});a.titles=c},a.parseFile=function(b){if("undefined"!=typeof b){var c=new FileReader;c.onload=function(b){var c=b.target.result,d=d3.csv.parseRows(c.replace(/\s*;/g,",")),e=d[0];a.data=d,a.formatTitles(a.hasTitles?e:[]),a.computeData()},c.readAsText(b)}else alert("error");return!1},a.saveData=function(){j.spin("spinner-1");var b="undefined"==typeof a.datasetId;b===!0&&(a.datasetId=removeAccents(a.datasetTitle)),a.$storage.datasets[a.datasetId]={title:a.datasetTitle,id:a.datasetId,data:a.data,titles:a.titles},b===!0?f.path("/dataset/edit/"+a.datasetId):a.data.length>0&&angular.element("#dataset_tableview").scope().reload(),j.stop("spinner-1")},a.deleteData=function(){delete e.datasets[a.datasetId],f.path("/")}}]),angular.module("newChartEditorApp").controller("NgTableCtrl",["$scope","$routeParams","$localStorage","ngTableParams","$filter",function(a,b,c,d){var e=function(){return a.data||[]};if(a.reload=function(){var b=a.$storage.datasets[a.datasetId];"undefined"!=typeof b&&(a.data=b.data,a.titles=b.titles,a.tableParams.reload())},a.datasetId=b.datasetId,a.$storage=c.$default({datasets:{}}),a.titles=[],a.tableParams=new d({page:1,count:10},{total:function(){return e().length},getData:function(a,b){var c=e(),d=c;b.total(d.length),a.resolve(d.slice((b.page()-1)*b.count(),b.page()*b.count()))}}),a.saveTitles=function(){a.$storage.datasets[a.datasetId].titles=a.titles},a.datasetId){var f=a.$storage.datasets[a.datasetId];"undefined"!=typeof f&&(a.data=f.data,a.titles=f.titles)}}]),angular.module("newChartEditorApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("newChartEditorApp").controller("MenuCtrl",["$scope","$rootScope","$localStorage","$location",function(a,b,c,d){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"],a.datasets=c.datasets,a.navType="pills",a.isActive=function(a){return b.currentDataset===a},a.setActive=function(a){b.currentDataset=a},b.currentDataset="",a.goNext=function(a){d.path(a)},a.deleteData=function(a){delete c.datasets[a],d.path("/")}}]);